---
# Beispiel für einen Recurring Backup Job
# Dieser Job erstellt tägliche Backups und behält die letzten 7 Backups
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: backup-daily
  namespace: longhorn-system
spec:
  # Cron Schedule (täglich um 2:00 Uhr nachts)
  cron: "0 2 * * *"
  
  # Task type: backup, backup-force-create, snapshot, snapshot-force-create, snapshot-cleanup, snapshot-delete, filesystem-trim
  task: "backup"
  
  # Anzahl der zu behaltenden Backups (7 = eine Woche)
  retain: 7
  
  # Concurrency - wie viele Volumes parallel gesichert werden
  concurrency: 2
  
  # Labels für Volume-Auswahl (optional - wenn leer, werden alle Volumes gesichert)
  labels:
    {}
    # Beispiel: nur Volumes mit diesem Label sichern
    # recurring-job.longhorn.io/backup-daily: enabled

---
# Wöchentliches Backup (Sonntags um 3:00 Uhr)
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: backup-weekly
  namespace: longhorn-system
spec:
  cron: "0 3 * * 0"  # Jeden Sonntag um 3:00 Uhr
  task: "backup"
  retain: 4  # 4 Wochen = 1 Monat
  concurrency: 2
  labels:
    {}

---
# Snapshot Cleanup Job (bereinigt alte Snapshots täglich)
apiVersion: longhorn.io/v1beta2
kind: RecurringJob
metadata:
  name: snapshot-cleanup-daily
  namespace: longhorn-system
spec:
  cron: "0 4 * * *"  # Täglich um 4:00 Uhr
  task: "snapshot-cleanup"
  retain: 1  # Behält nur den letzten Snapshot
  concurrency: 5
  labels:
    {}
