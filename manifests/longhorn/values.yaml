# Longhorn distributed storage values
persistence:
  defaultClass: true
  defaultClassReplicaCount: 2  # Reduziert von 3 auf 2 - HA bleibt, weniger Rebuild-Last
  defaultNodeSelector:
    enable: true
    selector: "storage"
  recurringJobSelector:
    enable: true
    jobList: '[{"name":"backup-daily","isGroup":false},{"name":"backup-weekly","isGroup":false},{"name":"snapshot-cleanup-daily","isGroup":false}]'

# Default backup store configuration  
defaultBackupStore:
  backupTarget: "s3://homelab-longhorn-elmstreet79@eu-central-1/"
  backupTargetCredentialSecret: "longhorn-s3-secret"

# Default settings
defaultSettings:
  defaultReplicaCount: "2"  # Reduziert von 3 auf 2 - weniger I/O-Last auf Control-Plane
  # RWX (ReadWriteMany) Support via NFS
  rwxVolumeFastFailover: "true"
  # Automatic replica rebalancing across nodes
  replicaAutoBalance: "best-effort"
  # Limit concurrent replica rebuilds per node to prevent overload (especially on Raspberry Pis)
  concurrentReplicaRebuildPerNodeLimit: "2"
  # Reduce backup concurrency to prevent overwhelming ARM nodes during nightly backups
  backupConcurrentLimit: "1"  # Default is 2, reduce to 1 to prevent raspi5 overload
  concurrentVolumeBackupRestorePerNodeLimit: "2"  # Default is 5, reduce to 2

# Disable preUpgrade hook (causes issues with ArgoCD)
preUpgradeChecker:
  jobEnabled: false
