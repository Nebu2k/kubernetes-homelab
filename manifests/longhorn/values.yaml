# Longhorn distributed storage values
persistence:
  defaultClass: true
  defaultClassReplicaCount: 3  # Konsistent mit defaultReplicaCount
  defaultNodeSelector:
    enable: true
    selector: "storage"
  recurringJobSelector:
    enable: true
    jobList: '[{"name":"backup","isGroup":true},{"name":"snapshot","isGroup":true}]'

# Default backup store configuration (MinIO on Proxmox VM)
defaultBackupStore:
    backupTarget: "s3://homelab-longhorn@us-east-1/"
    backupTargetCredentialSecret: longhorn-minio-secret
# Default settings
defaultSettings:
  defaultReplicaCount: "3"
  # RWX (ReadWriteMany) Support via NFS
  rwxVolumeFastFailover: "true"
  # Automatic replica rebalancing across nodes
  replicaAutoBalance: "best-effort"
  # Limit concurrent replica rebuilds per node to prevent overload (especially on Raspberry Pis)
  concurrentReplicaRebuildPerNodeLimit: "2"
  # Reduce backup concurrency to prevent overwhelming ARM nodes during nightly backups
  backupConcurrentLimit: "1"  # Default is 2, reduce to 1 to prevent raspi5 overload
  concurrentVolumeBackupRestorePerNodeLimit: "2"  # Default is 5, reduce to 2

# Disable preUpgrade hook (causes issues with ArgoCD)
preUpgradeChecker:
  jobEnabled: false
