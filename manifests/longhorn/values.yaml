# Longhorn distributed storage values
persistence:
  defaultClass: true
  defaultClassReplicaCount: 2  # Reduziert von 3 auf 2 - HA bleibt, weniger Rebuild-Last
  defaultNodeSelector:
    enable: true
    selector: "storage"
  recurringJobSelector:
    enable: true
    jobList: '[{"name":"backup-nfs-daily","isGroup":false},{"name":"backup-nfs-weekly","isGroup":false},{"name":"snapshot-cleanup-daily","isGroup":false}]'

# Default backup store configuration (now NFS, S3 as secondary target)
defaultBackupStore:
  backupTarget: "nfs://192.168.2.6:/var/nfs/shared/longhorn_backup?nfsOptions=vers=3"
  backupTargetCredentialSecret: ""

# Default settings
defaultSettings:
  defaultReplicaCount: "3"
  # RWX (ReadWriteMany) Support via NFS
  rwxVolumeFastFailover: "true"
  # Automatic replica rebalancing across nodes
  replicaAutoBalance: "best-effort"
  # Limit concurrent replica rebuilds per node to prevent overload (especially on Raspberry Pis)
  concurrentReplicaRebuildPerNodeLimit: "2"
  # Reduce backup concurrency to prevent overwhelming ARM nodes during nightly backups
  backupConcurrentLimit: "1"  # Default is 2, reduce to 1 to prevent raspi5 overload
  concurrentVolumeBackupRestorePerNodeLimit: "2"  # Default is 5, reduce to 2

# Disable preUpgrade hook (causes issues with ArgoCD)
preUpgradeChecker:
  jobEnabled: false
