apiVersion: v1
kind: ConfigMap
metadata:
  name: home-assistant-config-cm
  namespace: home-assistant
data:
  configuration.yaml: |
    # HTTP config - trust pod network for reverse proxy (DualStack)
    http:
      use_x_forwarded_for: true
      trusted_proxies:
        # IPv4 Ranges
        - 10.42.0.0/16
        - 172.16.0.0/12
        - 192.168.0.0/16
        # IPv6 Ranges
        - fd00:cafe:beef::/48      # ULA Kubernetes LoadBalancer
        - fd00::/8                 # All ULA (Kubernetes pods)
      ip_ban_enabled: true
      login_attempts_threshold: 5
    
    # Enable discovery for automatic device detection
    default_config:
    
    # Enable automations UI
    automation: !include automations.yaml
    
    # Enable scripts UI
    script: !include scripts.yaml
    
    # Enable scenes UI
    scene: !include scenes.yaml